package com.bio.database;

import com.bio.entity.Feed;
import com.bio.value.FeedValue;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class FeedDatabase {

    public static String createTable = "CREATE TABLE IF NOT EXISTS feed (id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, name TEXT)";
    public static String insert = "INSERT INTO feed (name) VALUES (?) RETURNING id";
    public static String select = "SELECT id, name FROM feed ORDER BY id";
    public static String selectById = "SELECT id, name FROM feed WHERE id = ?";
    public static String deleteById = "DELETE FROM feed WHERE id = ?";

    public static void prepareInsert(PreparedStatement statement, FeedValue feedValue) throws SQLException {
        statement.setString(1, feedValue.getName());
    }

    public static Feed get(ResultSet rs) throws SQLException {
        Feed feed = new Feed();
        feed.setId(rs.getLong(1));
        feed.setName(rs.getString(2));
        return feed;
    }

    public static void prepareSelectById(PreparedStatement statement, Long id) throws SQLException {
        statement.setLong(1, id);
    }

    public static void prepareDeleteById(PreparedStatement statement, Long id) throws SQLException {
        statement.setLong(1, id);
    }

}
